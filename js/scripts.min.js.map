{"version":3,"sources":["video_player.js"],"names":["intoSeconds","seconds","showHours","hours","Math","floor","minutes","slice","parseInt","time","secondsFromTimespan","timeSpan","indexOf","parts","split","videoContainer","document","createElement","canPlayType","getElementById","video","videoControls","controls","setAttribute","playpause","stop","mute","volinc","voldec","progress","progressBar","fullscreen","fullScreenEnabled","fullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled","webkitSupportsFullscreen","webkitFullscreenEnabled","webkitRequestFullScreen","style","display","checkVolume","dir","currentVolume","volume","muted","changeButtonState","alterVolume","setFullscreenData","state","isFullScreen","fullScreen","webkitIsFullScreen","mozFullScreen","msFullscreenElement","fullscreenElement","handleFullscreen","exitFullscreen","mozCancelFullScreen","webkitCancelFullScreen","msExitFullscreen","requestFullscreen","mozRequestFullScreen","msRequestFullscreen","addEventListener","duration","type","paused","ended","e","$","transcript","removeClass","play","pause","currentTime","value","fs","getAttribute","width","pos","pageX","this","offsetLeft","offsetParent","offsetWidth","$buttonsToHide","$videoContainer","$controls","children","mouseenter","fadeIn","animate","bottom","mouseleave","fadeOut","$video","on","html","i","each","start","attr","startNum","parseFloat","addClass","length"],"mappings":"CAAA,WACA,YA8MA,SAAAA,GAAAC,EAAAC,GACA,GAAAA,EACA,GAAAC,GAAAC,KAAAC,MAAAJ,EAAA,MACAA,EAAAA,EAAA,KAAAE,CAEA,IAAAG,IAAA,IAAAF,KAAAC,MAAAJ,EAAA,KAAAM,UACAN,GAAA,IAAAO,SAAAP,EAAA,GAAA,KAAAM,SAEA,IAAAL,EACA,GAAAO,GAAAN,EAAA,IAAAG,EAAA,IAAAL,MAEA,IAAAQ,GAAAH,EAAA,IAAAL,EAAA,IAEA,OAAAQ,GASA,QAAAC,GAAAC,GACA,IAAAA,IAAAA,EAAAC,QAAA,KAAA,MAAA,EACA,IAAAC,GAAAF,EAAAG,MAAA,IACA,OAAA,KAAAD,EAAA,GAAAA,EAAA,GAlOA,GAGAE,MAHAC,SAAAC,cAAA,SAAAC,YAGAF,SAAAG,eAAA,mBACAC,EAAAJ,SAAAG,eAAA,SACAE,EAAAL,SAAAG,eAAA,iBAKAC,GAAAE,UAAA,EACAD,EAAAE,aAAA,aAAA,UAKA,IAAAC,GAAAR,SAAAG,eAAA,aACAM,EAAAT,SAAAG,eAAA,QACAO,EAAAV,SAAAG,eAAA,QACAQ,EAAAX,SAAAG,eAAA,UACAS,EAAAZ,SAAAG,eAAA,UACAU,EAAAb,SAAAG,eAAA,YACAW,EAAAd,SAAAG,eAAA,gBACAY,EAAAf,SAAAG,eAAA,MAMAa,GALAhB,SAAAG,eAAA,gBAKAH,SAAAiB,mBAAAjB,SAAAkB,sBAAAlB,SAAAmB,qBAAAnB,SAAAoB,0BAAApB,SAAAqB,yBAAArB,SAAAC,cAAA,SAAAqB,yBAKAN,KACAD,EAAAQ,MAAAC,QAAA,OAMA,IAAAC,GAAA,SAAAC,GACA,GAAAA,EAAA,CACA,GAAAC,GAAAvC,KAAAC,MAAA,GAAAe,EAAAwB,QAAA,EACA,OAAAF,EACAC,EAAA,IAAAvB,EAAAwB,QAAA,IAEA,MAAAF,GACAC,EAAA,IAAAvB,EAAAwB,QAAA,IAEAD,GAAA,EAAAvB,EAAAyB,OAAA,EACAzB,EAAAyB,OAAA,EAEAC,EAAA,SAMAC,EAAA,SAAAL,GACAD,EAAAC,IAMAM,EAAA,SAAAC,GACAlC,EAAAQ,aAAA,oBAAA0B,GACAlB,EAAAR,aAAA,aAAA0B,EAAA,oBAAA,kBAMAC,EAAA,WACA,SAAAlC,SAAAmC,YAAAnC,SAAAoC,oBAAApC,SAAAqC,eAAArC,SAAAsC,qBAAAtC,SAAAuC,oBAGAC,EAAA,WACAN,KACAlC,SAAAyC,eAAAzC,SAAAyC,iBACAzC,SAAA0C,oBAAA1C,SAAA0C,sBACA1C,SAAA2C,uBAAA3C,SAAA2C,yBACA3C,SAAA4C,kBAAA5C,SAAA4C,mBACAZ,GAAA,KAGAjC,EAAA8C,kBAAA9C,EAAA8C,oBACA9C,EAAA+C,qBAAA/C,EAAA+C,uBACA/C,EAAAuB,wBACAlB,EAAAkB,0BAEAvB,EAAAgD,qBAAAhD,EAAAgD,sBACAf,GAAA,IAIA,IAAAhC,SAAAgD,iBAAA,CACA5C,EAAA4C,iBAAA,iBAAA,WACAnC,EAAAN,aAAA,MAAAH,EAAA6C,WAMA,IAAAnB,GAAA,SAAAoB,GAEA,aAAAA,EACA9C,EAAA+C,QAAA/C,EAAAgD,MACA5C,EAAAD,aAAA,aAAA,QAGAC,EAAAD,aAAA,aAAA,SAIA,QAAA2C,GACAxC,EAAAH,aAAA,aAAAH,EAAAyB,MAAA,SAAA,QAOAzB,GAAA4C,iBAAA,OAAA,WACAlB,EAAA,eACA,GACA1B,EAAA4C,iBAAA,QAAA,WACAlB,EAAA,eACA,GACA1B,EAAA4C,iBAAA,eAAA,WACAvB,MACA,GACAjB,EAAAwC,iBAAA,QAAA,SAAAK,GACAC,EAAAC,GAAAC,YAAA,aACApD,EAAA+C,QAAA/C,EAAAgD,MAAAhD,EAAAqD,OACArD,EAAAsD,UAGAjD,EAAAuC,iBAAA,QAAA,SAAAK,GACAjD,EAAAsD,QACAtD,EAAAuD,YAAA,EACA9C,EAAA+C,MAAA,EACA9B,EAAA,eAEApB,EAAAsC,iBAAA,QAAA,SAAAK,GACAjD,EAAAyB,OAAAzB,EAAAyB,MACAC,EAAA,UAEAnB,EAAAqC,iBAAA,QAAA,SAAAK,GACAtB,EAAA,OAEAnB,EAAAoC,iBAAA,QAAA,SAAAK,GACAtB,EAAA,OAEA8B,GAAAb,iBAAA,QAAA,SAAAK,GACAb,MAMApC,EAAA4C,iBAAA,aAAA,WACAnC,EAAAiD,aAAA,QAAAjD,EAAAN,aAAA,MAAAH,EAAA6C,UACApC,EAAA+C,MAAAxD,EAAAuD,YACA7C,EAAAS,MAAAwC,MAAA3E,KAAAC,MAAAe,EAAAuD,YAAAvD,EAAA6C,SAAA,KAAA,MAGApC,EAAAmC,iBAAA,QAAA,SAAAK,GACAC,EAAAC,GAAAC,YAAA,YACA,IAAAQ,IAAAX,EAAAY,OAAAC,KAAAC,WAAAD,KAAAE,aAAAD,WAAAD,KAAAE,aAAAA,aAAAD,aAAAD,KAAAG,WACAjE,GAAAuD,YAAAK,EAAA5D,EAAA6C,WAQA,GAAAqB,GAAAhB,EAAA,eACAiB,EAAAjB,EAAA,mBACAkB,EAAAlB,EAAA,YACAA,GAAA,kCAAAmB,SAAA,YAEAF,GAAAG,WAAA,WACAJ,EAAAK,OAAA,KACAH,EAAA/D,OAAAmE,SACAC,OAAA,QACA,OAGAN,EAAAO,WAAA,WACAR,EAAAS,QAAA,KACAP,EAAA/D,OAAAmE,SACAC,OAAA,QACA,MAsBA,IAAAG,GAAA1B,EAAA,SACA0B,GAAAC,GAAA,aAAA,WACA3B,EAAA,YAAA4B,KAAAlG,EAAAgG,EAAA,GAAArB,cACAL,EAAA,aAAA4B,KAAAlG,EAAAgG,EAAA,GAAA/B,YASA,IAAAM,GAAAD,EAAA,oBACA6B,EAAA,EACA1F,EAAAT,EAAAoB,EAAAuD,YAEAL,GAAA8B,KAAA7B,EAAA,WACA,GAAA8B,GAAA/B,EAAAC,EAAA4B,IAAAG,KAAA,cACAC,EAAAC,WAAAH,EACA5F,IAAA8F,EACAjC,EAAAC,EAAA4B,IAAAM,SAAA,aAEAnC,EAAAC,EAAA4B,IAAA3B,YAAA,aAEA2B,MAGA/E,EAAA4C,iBAAA,aAAA,WACA,IAAAmC,EAAA,EAAAA,EAAA5B,EAAAmC,OAAAP,IACAzF,EAAA4D,EAAAC,EAAA4B,IAAAG,KAAA,gBAAAlG,KAAAC,MAAAe,EAAAuD,eACA,IAAAwB,EACA7B,EAAAC,EAAA4B,IAAAM,SAAA,cAEAnC,EAAAC,EAAA4B,EAAA,IAAA3B,YAAA,aACAF,EAAAC,EAAA4B,IAAAM,SAAA","file":"scripts.min.js","sourcesContent":["(function () {\r\n  'use strict';\r\n\r\n  /*********************************************\r\n  ***** Support the video element?\r\n  *********************************************/\r\n  var supportsVideo = !!document.createElement('video').canPlayType;\r\n\r\n  // if (supportsVideo) {\r\n    var videoContainer = document.getElementById('videoContainer');\r\n    var video = document.getElementById('video');\r\n    var videoControls = document.getElementById('video-controls');\r\n\r\n  /*********************************************\r\n  ***** Hide default controls, display custom controls\r\n  *********************************************/\r\n    video.controls = false;\r\n    videoControls.setAttribute('data-state', 'visible');\r\n\r\n  /*********************************************\r\n  ***** Elements\r\n  *********************************************/\r\n    var playpause = document.getElementById('playpause');\r\n    var stop = document.getElementById('stop');\r\n    var mute = document.getElementById('mute');\r\n    var volinc = document.getElementById('volinc');\r\n    var voldec = document.getElementById('voldec');\r\n    var progress = document.getElementById('progress');\r\n    var progressBar = document.getElementById('progress-bar');\r\n    var fullscreen = document.getElementById('fs');\r\n    var subtitles = document.getElementById('subtitles');\r\n\r\n  /*********************************************\r\n  ***** Fullscreen API support ?\r\n  *********************************************/\r\n    var fullScreenEnabled = !!(document.fullscreenEnabled || document.mozFullScreenEnabled || document.msFullscreenEnabled || document.webkitSupportsFullscreen || document.webkitFullscreenEnabled || document.createElement('video').webkitRequestFullScreen);\r\n\r\n  /*********************************************\r\n  ***** If the browser doesn't support the Fulscreen API then hide the fullscreen button\r\n  *********************************************/\r\n    if (!fullScreenEnabled) {\r\n      fullscreen.style.display = 'none';\r\n    }\r\n\r\n  /*********************************************\r\n  ***** Check the volume\r\n  *********************************************/\r\n    var checkVolume = function(dir) {\r\n      if (dir) {\r\n        var currentVolume = Math.floor(video.volume * 10) / 10;\r\n        if (dir === '+') {\r\n          if (currentVolume < 1) video.volume += 0.1;\r\n        }\r\n        else if (dir === '-') {\r\n          if (currentVolume > 0) video.volume -= 0.1;\r\n        }\r\n        if (currentVolume <= 0) video.muted = true;\r\n        else video.muted = false;\r\n      }\r\n      changeButtonState('mute');\r\n    };\r\n\r\n  /*********************************************\r\n  ***** Alter the volume\r\n  *********************************************/\r\n    var alterVolume = function(dir) {\r\n      checkVolume(dir);\r\n    };\r\n\r\n  /*********************************************\r\n  ***** Fullscreen\r\n  *********************************************/\r\n    var setFullscreenData = function(state) {\r\n      videoContainer.setAttribute('data-fullscreen', !!state);\r\n      fullscreen.setAttribute('data-state', !!state ? 'cancel-fullscreen' : 'go-fullscreen');\r\n    };\r\n\r\n  /************************************************************\r\n  ***** Checks if the document is currently in fullscreen mode\r\n  ************************************************************/\r\n    var isFullScreen = function() {\r\n      return !!(document.fullScreen || document.webkitIsFullScreen || document.mozFullScreen || document.msFullscreenElement || document.fullscreenElement);\r\n    };\r\n\r\n    var handleFullscreen = function() {\r\n      if (isFullScreen()) {\r\n        if (document.exitFullscreen) document.exitFullscreen();\r\n        else if (document.mozCancelFullScreen) document.mozCancelFullScreen();\r\n        else if (document.webkitCancelFullScreen) document.webkitCancelFullScreen();\r\n        else if (document.msExitFullscreen) document.msExitFullscreen();\r\n        setFullscreenData(false);\r\n      }\r\n      else {\r\n        if (videoContainer.requestFullscreen) videoContainer.requestFullscreen();\r\n        else if (videoContainer.mozRequestFullScreen) videoContainer.mozRequestFullScreen();\r\n        else if (videoContainer.webkitRequestFullScreen) {\r\n          video.webkitRequestFullScreen();\r\n        }\r\n        else if (videoContainer.msRequestFullscreen) videoContainer.msRequestFullscreen();\r\n        setFullscreenData(true);\r\n      }\r\n    };\r\n\r\n    if (document.addEventListener) {\r\n      video.addEventListener('loadedmetadata', function() {\r\n        progress.setAttribute('max', video.duration);\r\n      });\r\n\r\n  /*********************************************\r\n  ***** Changes the button state\r\n  *********************************************/\r\n    var changeButtonState = function(type) {\r\n      // Play/Pause button\r\n      if (type == 'playpause') {\r\n        if (video.paused || video.ended) {\r\n          playpause.setAttribute('data-state', 'play');\r\n        }\r\n        else {\r\n          playpause.setAttribute('data-state', 'pause');\r\n        }\r\n      }\r\n      // Mute button\r\n      else if (type == 'mute') {\r\n        mute.setAttribute('data-state', video.muted ? 'unmute' : 'mute');\r\n      }\r\n    };\r\n\r\n  /*********************************************\r\n  ***** Events\r\n  *********************************************/\r\n    video.addEventListener('play', function() {\r\n      changeButtonState('playpause');\r\n    }, false);\r\n    video.addEventListener('pause', function() {\r\n      changeButtonState('playpause');\r\n    }, false);\r\n    video.addEventListener('volumechange', function() {\r\n      checkVolume();\r\n    }, false);    \r\n    playpause.addEventListener('click', function(e) {\r\n      $(transcript).removeClass(\"highlight\");\r\n      if (video.paused || video.ended) video.play();\r\n      else video.pause();\r\n    }); \r\n\r\n    stop.addEventListener('click', function(e) {\r\n      video.pause();\r\n      video.currentTime = 0;\r\n      progress.value = 0;\r\n      changeButtonState('playpause');\r\n    });\r\n    mute.addEventListener('click', function(e) {\r\n      video.muted = !video.muted;\r\n      changeButtonState('mute');\r\n    });\r\n    volinc.addEventListener('click', function(e) {\r\n      alterVolume('+');\r\n    });\r\n    voldec.addEventListener('click', function(e) {\r\n      alterVolume('-');\r\n    });\r\n    fs.addEventListener('click', function(e) {\r\n      handleFullscreen();\r\n    });\r\n\r\n  /*********************************************\r\n  ***** Update the progress bar\r\n  *********************************************/\r\n    video.addEventListener('timeupdate', function() {\r\n      if (!progress.getAttribute('max')) progress.setAttribute('max', video.duration);\r\n      progress.value = video.currentTime;\r\n      progressBar.style.width = Math.floor((video.currentTime / video.duration) * 100) + '%';\r\n    });\r\n\r\n    progress.addEventListener('click', function(e) {\r\n      $(transcript).removeClass(\"highlight\");\r\n      var pos = (e.pageX  - (this.offsetLeft + this.offsetParent.offsetLeft + this.offsetParent.offsetParent.offsetLeft)) / this.offsetWidth;\r\n      video.currentTime = pos * video.duration;\r\n    });\r\n  }\r\n // }\r\n\r\n  /******************************************\r\n  ***** Hide controls except Progress Bar\r\n  ******************************************/\r\n  var $buttonsToHide = $(\"button.hide\");\r\n  var $videoContainer = $(\"#videoContainer\");\r\n  var $controls = $(\".controls\");\r\n  var $dataFullscreenControls = $('figure[data-fullscreen=\"true\"]').children('.controls');\r\n\r\n  $videoContainer.mouseenter(function () {\r\n    $buttonsToHide.fadeIn(400);\r\n    $controls.stop().animate({\r\n    bottom: \"50px\"\r\n   }, 400);\r\n  });\r\n\r\n  $videoContainer.mouseleave(function () {\r\n    $buttonsToHide.fadeOut(400);\r\n    $controls.stop().animate({\r\n    bottom: \"20px\"\r\n   }, 400);\r\n  });\r\n\r\n  /******************************************\r\n  ***** Highlight Text from Video\r\n  ******************************************/\r\n  function intoSeconds(seconds, showHours) {\r\n    if(showHours) {\r\n        var hours = Math.floor(seconds / 3600),\r\n            seconds = seconds - hours * 3600;\r\n    }\r\n    var minutes = (\"0\" + Math.floor(seconds/60)).slice(-2);\r\n    var seconds = (\"0\" + parseInt(seconds%60,10)).slice(-2);\r\n\r\n    if(showHours) {\r\n        var time = hours + \":\" + minutes + \":\" +  seconds;\r\n    } else {\r\n        var time = minutes + \":\" + seconds + \" \" + \"/\";\r\n    }\r\n    return time;\r\n  }\r\n\r\n  var $video = $('#video');\r\n  $video.on(\"timeupdate\", function () {\r\n    $('#current').html(intoSeconds($video[0].currentTime));\r\n    $('#duration').html(intoSeconds($video[0].duration));\r\n  });\r\n\r\n  function secondsFromTimespan(timeSpan) {\r\n    if(!timeSpan || !timeSpan.indexOf(':')) return 0;\r\n    var parts = timeSpan.split(':');\r\n    return + parts[0] * 60 + parts[1];\r\n  }\r\n\r\n  var transcript = $(\"span[data-start]\");\r\n  var i = 0;\r\n  var time = intoSeconds(video.currentTime);\r\n\r\n  $.each(transcript, function() {\r\n    var start = $(transcript[i]).attr(\"data-start\");\r\n    var startNum = parseFloat(start);\r\n    if (time >= startNum) {\r\n      $(transcript[i]).addClass(\"highlight\");\r\n    } else {\r\n      $(transcript[i]).removeClass(\"highlight\");\r\n    }\r\n    i++;\r\n  });\r\n\r\n  video.addEventListener('timeupdate', function() {\r\n    for(i=0; i < transcript.length; i++) {\r\n      if(secondsFromTimespan($(transcript[i]).attr(\"data-start\")) == Math.floor(video.currentTime)){\r\n        if(i === 0) {\r\n           $(transcript[i]).addClass(\"highlight\");\r\n        }else{\r\n           $(transcript[i-1]).removeClass(\"highlight\");\r\n           $(transcript[i]).addClass(\"highlight\");\r\n        }\r\n      }\r\n    }\r\n  });\r\n})();\r\n"]}